@page
@model Learn_Academy.Pages.Purchase.IndexModel
@using Microsoft.EntityFrameworkCore;
@using Learn_Academy.Models;
    @{
        ViewData["Title"] = "Index";
        Layout = "~/Pages/Shared/_Layout.cshtml";
    }

    <h1>Index</h1>

    <p>
        <a asp-page="Create">Create New</a>
    </p>
    <table class="table">
        <thead>
            <tr>
                <th>
                    @Html.DisplayNameFor(model => model.Membership[0].ExpiryDate)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.Membership[0].Date)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.Membership[0].Plan)
                </th>
                <th></th>
            </tr>
        </thead>
        <tbody>

            @foreach (var item in (List<Membership>) ViewData["Membership"])
            {

                @if (item.ApplicationUser.Email == User.Identity.Name)
                {
                    <tr>
                        <td>
                            @Html.DisplayFor(modelItem => item.ExpiryDate)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Date)
                        </td>
                        <td>
                            @if (item.Plan == 1)
                            {
                                <span>Monthly</span>
                            }
                            else if (item.Plan == 2)
                            {
                                <span>Monthly</span>
                            }
                            else if (item.Plan == 3)
                            {
                                <span>Lifetime</span>
                            }
                        </td>
                        <td>
                            <a asp-page="./Details" asp-route-id="@item.PurchaseId">Details</a>
                        </td>
                    </tr>
                }

            }
        </tbody>
    </table>
